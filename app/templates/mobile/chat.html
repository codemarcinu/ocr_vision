{% extends "mobile/base.html" %}

{% block title %}Czat - Second Brain{% endblock %}

{% block content %}
<div class="chat-container" id="chat-container">
  {% if messages %}
    {% for msg in messages %}
    <div class="message {{ msg.role }}">
      <div class="message-content">{{ msg.content | safe }}</div>
      {% if msg.sources and msg.sources | length > 0 %}
      <div class="message-sources">
        <small class="sources-label">Å¹rÃ³dÅ‚a:</small>
        {% for source in msg.sources[:3] %}
        <a href="{{ source.url }}" class="source-link" target="_blank">{{ source.title[:30] }}{% if source.title|length > 30 %}...{% endif %}</a>
        {% endfor %}
      </div>
      {% endif %}
      <div class="message-time">{{ msg.created_at.strftime('%H:%M') if msg.created_at else '' }}</div>
    </div>
    {% endfor %}
  {% else %}
    <div class="empty-state" id="empty-state">
      <div class="icon">ðŸ’¬</div>
      <h2>CzeÅ›Ä‡!</h2>
      <p>Jestem Twoim asystentem. Pytaj o wydatki, twÃ³rz notatki, lub po prostu rozmawiaj.</p>
      <div class="suggestions">
        <button class="suggestion-chip" data-text="Ile wydaÅ‚em w tym miesiÄ…cu?">Ile wydaÅ‚em w tym miesiÄ…cu?</button>
        <button class="suggestion-chip" data-text="Zanotuj: kupiÄ‡ mleko">Zanotuj: kupiÄ‡ mleko</button>
        <button class="suggestion-chip" data-text="Podsumuj ostatnie artykuÅ‚y">Podsumuj ostatnie artykuÅ‚y</button>
        <button class="suggestion-chip" data-text="Co nowego w AI?">Co nowego w AI?</button>
      </div>
    </div>
  {% endif %}
</div>

<!-- Hidden input for file uploads -->
<input type="file" id="file-input" accept="image/*,.pdf" capture="environment" style="display: none;">
{% endblock %}

{% block extra_scripts %}
<script>
  // Pass session ID from server if exists
  {% if session_id %}
  window.initialSessionId = "{{ session_id }}";
  {% endif %}
</script>
{% endblock %}
